<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Github users</title>
    <link rel="stylesheet" href="css/style.css" />
  </head>
  <body>
    <div id="root"></div>

    <script
      crossorigin
      src="https://unpkg.com/react@16.8.3/umd/react.development.js"
    ></script>
    <script
      crossorigin
      src="https://unpkg.com/react-dom@16.8.3/umd/react-dom.development.js"
    ></script>
    <script
      crossorigin
      src="https://unpkg.com/prop-types@15.7.2/prop-types.js"
    ></script>
    <script
      crossorigin
      src="https://unpkg.com/babel-standalone@6.26.0/babel.min.js"
    ></script>

    <script type="text/babel">
      const root = document.getElementById("root");

      function From(props){

        const [value, setValue] = React.useState('');
        const update = e => setValue(e.target.value);

        const handleSubmit = e => {
          e.preventDefault();
          props.submit(value)
          setValue('')
        }

        return (
          <form onSubmit={handleSubmit}>
            <div className="form-box">
              <div className="form-box__item">
                <input
                  type="text"
                  value={value}
                  onChange={update}
                />
                <button>Add user</button>
              </div>
            </div>
          </form>
        )
      }


      const Cart = ({ profile, removeItem }) => {
        return (
          <div className="cart">
            <h3>{profile.id}</h3>
            <p>{profile.login}</p>
            <img src={profile.avatar_url} alt="https://placehold.it/75" />
            <button className='btn btn-danger btn-sm' onClick={() => removeItem(profile.id)}>Remove</button>
          </div>
        )
      }

      const CartList = ({ data, removeItem }) => {
        return (
          <div>
            {data.map(profile => (
                <Cart key={profile.id} profile={profile} removeItem={removeItem} />
            ))}
          </div>
        )
      }

      function App() {
        let [data, setData] = React.useState([])

        const addUser = async value => {
          const url = `https://api.github.com/users/${value}`
          const result = await fetch(url)
          const user = await result.json();
          setData(data = [...data, user])
        }

        const removeItem = id => setData(data.filter(el => el.id !== id))

        return (
          <div className='container'>
            <From submit={addUser} />
            <CartList data={data} removeItem={removeItem} />
          </div>
        )

      }

      /*class Form extends React.Component {
        state = {
          value: "",
        };
        update = event => this.setState({ value: event.target.value })
        handleSubmit = event => {
          event.preventDefault();
          this.props.submit(this.state.value);
          this.setState({ value: "" });
        }
        render() {
          return (
                  <form onSubmit={this.handleSubmit}>
                    <div className="form-box">
                      <div className="form-box__item">
                        <input
                                type="text"
                                value={this.state.value}
                                onChange={this.update}
                        />
                        <button>Add user</button>
                      </div>
                    </div>
                  </form>
          )
        }
      }
      const Cart = ({ profile }) => (
              <div className="cart">
                <h3>{profile.name}</h3>
                <p>{profile.login}</p>
                <img src={profile.avatar_url} alt="https://placehold.it/75"/>
              </div>
      )
      const CartList = ({ data }) => (
              <div className="cart-box">
                {data.map(profile => (
                        <Cart key={profile.id} profile={profile} />
                ))}
              </div>
      )*/

      /*class App extends React.Component {
        state = {
          data: []
        }
        addUser = async userName => {
          const url =`https://api.github.com/users/${userName}`;
          const response = await fetch(url);
          const user = await response.json();
          this.setState({ data: [...this.state.data, user] });
        }
        render() {
          return (
                  <div className="container">
                    <Form submit={this.addUser} />
                    <CartList data={this.state.data}/>
                  </div>
          )
        }
      }*/

      ReactDOM.render(<App />, root);
    </script>
  </body>
</html>
